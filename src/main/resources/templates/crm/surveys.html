<!doctype html>
<html class="light" lang="vi" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="~{fragments/layout :: head(title='Khảo sát hài lòng')}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body
    class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 font-sans h-screen flex overflow-hidden"
  >
    <div th:replace="~{fragments/layout :: sidebar-backdrop}"></div>
    <aside th:replace="~{fragments/layout :: admin-sidebar}"></aside>

    <main
      class="flex-1 flex flex-col min-w-0 bg-background-light dark:bg-background-dark"
    >
      <header
        th:replace="~{fragments/header/unified-header :: unified-header}"
      ></header>

      <div class="flex-1 overflow-y-auto p-6 lg:p-8">
        <div class="max-w-7xl mx-auto flex flex-col gap-6">
          <!-- Page Header -->
          <div
            class="flex flex-col md:flex-row md:items-center justify-between gap-4"
          >
            <div>
              <h2
                class="text-3xl font-black tracking-tight text-slate-900 dark:text-white"
              >
                Khảo sát hài lòng
              </h2>
              <p class="text-slate-500 dark:text-slate-400 mt-1">
                Quản lý khảo sát và phân tích phản hồi khách hàng
              </p>
            </div>
            <button
              class="bg-primary text-white px-4 py-2.5 rounded-lg text-sm font-semibold hover:bg-primary-dark transition-colors flex items-center gap-2 shadow-sm shadow-primary/30"
            >
              <span class="material-symbols-outlined text-[20px]">add</span>
              Tạo khảo sát mới
            </button>
          </div>

          <!-- Stats Cards -->
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div
              class="bg-white dark:bg-[#1a2634] rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm hover:shadow-md transition-shadow"
            >
              <div class="flex items-start justify-between">
                <div>
                  <p
                    class="text-sm font-medium text-slate-500 dark:text-slate-400"
                  >
                    Khảo sát đang chạy
                  </p>
                  <h3
                    class="text-2xl font-bold text-slate-900 dark:text-white mt-1"
                  >
                    12
                  </h3>
                </div>
                <div
                  class="p-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-primary"
                >
                  <span class="material-symbols-outlined">assignment</span>
                </div>
              </div>
            </div>
            <div
              class="bg-white dark:bg-[#1a2634] rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm hover:shadow-md transition-shadow"
            >
              <div class="flex items-start justify-between">
                <div>
                  <p
                    class="text-sm font-medium text-slate-500 dark:text-slate-400"
                  >
                    Phản hồi tháng này
                  </p>
                  <h3
                    class="text-2xl font-bold text-emerald-600 dark:text-emerald-400 mt-1"
                  >
                    3,456
                  </h3>
                </div>
                <div
                  class="p-2 bg-emerald-50 dark:bg-emerald-900/30 rounded-lg text-emerald-600 dark:text-emerald-400"
                >
                  <span class="material-symbols-outlined">groups</span>
                </div>
              </div>
            </div>
            <div
              class="bg-white dark:bg-[#1a2634] rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm hover:shadow-md transition-shadow"
            >
              <div class="flex items-start justify-between">
                <div>
                  <p
                    class="text-sm font-medium text-slate-500 dark:text-slate-400"
                  >
                    Điểm hài lòng TB
                  </p>
                  <h3
                    class="text-2xl font-bold text-amber-600 dark:text-amber-400 mt-1"
                  >
                    4.6
                  </h3>
                </div>
                <div
                  class="p-2 bg-amber-50 dark:bg-amber-900/30 rounded-lg text-amber-600 dark:text-amber-400"
                >
                  <span class="material-symbols-outlined">star</span>
                </div>
              </div>
            </div>
            <div
              class="bg-white dark:bg-[#1a2634] rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm hover:shadow-md transition-shadow"
            >
              <div class="flex items-start justify-between">
                <div>
                  <p
                    class="text-sm font-medium text-slate-500 dark:text-slate-400"
                  >
                    Tỷ lệ phản hồi
                  </p>
                  <h3
                    class="text-2xl font-bold text-purple-600 dark:text-purple-400 mt-1"
                  >
                    68%
                  </h3>
                </div>
                <div
                  class="p-2 bg-purple-50 dark:bg-purple-900/30 rounded-lg text-purple-600 dark:text-purple-400"
                >
                  <span class="material-symbols-outlined">trending_up</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Charts Row -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div
              class="bg-white dark:bg-[#1a2634] rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm"
            >
              <h3 class="text-lg font-bold text-slate-900 dark:text-white mb-4">
                Điểm hài lòng theo tháng
              </h3>
              <canvas id="satisfactionChart" height="200"></canvas>
            </div>
            <div
              class="bg-white dark:bg-[#1a2634] rounded-xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm"
            >
              <h3 class="text-lg font-bold text-slate-900 dark:text-white mb-4">
                Phân bố đánh giá
              </h3>
              <canvas id="distributionChart" height="200"></canvas>
            </div>
          </div>

          <!-- Survey List -->
          <div
            class="bg-white dark:bg-[#1a2634] rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden"
          >
            <div
              class="p-5 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between"
            >
              <h3 class="text-lg font-bold text-slate-900 dark:text-white">
                Danh sách khảo sát
              </h3>
              <div class="flex gap-2">
                <select
                  class="px-3 py-1.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm"
                >
                  <option>Tất cả trạng thái</option>
                  <option>Đang chạy</option>
                  <option>Đã kết thúc</option>
                </select>
              </div>
            </div>
            <div class="overflow-x-auto">
              <table class="w-full">
                <thead class="bg-slate-50 dark:bg-slate-800/50">
                  <tr>
                    <th
                      class="px-5 py-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider"
                    >
                      Khảo sát
                    </th>
                    <th
                      class="px-5 py-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider"
                    >
                      Phản hồi
                    </th>
                    <th
                      class="px-5 py-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider"
                    >
                      Điểm TB
                    </th>
                    <th
                      class="px-5 py-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider"
                    >
                      Trạng thái
                    </th>
                    <th
                      class="px-5 py-3 text-right text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider"
                    >
                      Thao tác
                    </th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-slate-200 dark:divide-slate-700">
                  <tr class="hover:bg-slate-50 dark:hover:bg-slate-800/50">
                    <td class="px-5 py-4">
                      <div class="flex items-center gap-3">
                        <div
                          class="w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center"
                        >
                          <span class="material-symbols-outlined text-primary"
                            >assignment</span
                          >
                        </div>
                        <div>
                          <p class="font-medium text-slate-900 dark:text-white">
                            Khảo sát dịch vụ khám bệnh
                          </p>
                          <p class="text-sm text-slate-500 dark:text-slate-400">
                            Tạo: 15/01/2026
                          </p>
                        </div>
                      </div>
                    </td>
                    <td class="px-5 py-4 text-slate-600 dark:text-slate-400">
                      1,234
                    </td>
                    <td class="px-5 py-4">
                      <div class="flex items-center gap-1">
                        <span
                          class="material-symbols-outlined text-amber-500 text-[18px]"
                          >star</span
                        >
                        <span class="font-medium text-slate-900 dark:text-white"
                          >4.7</span
                        >
                      </div>
                    </td>
                    <td class="px-5 py-4">
                      <span
                        class="px-2.5 py-1 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-xs font-semibold rounded-full"
                        >Đang chạy</span
                      >
                    </td>
                    <td class="px-5 py-4 text-right">
                      <button
                        class="text-primary hover:text-primary-dark font-medium text-sm"
                      >
                        Xem chi tiết
                      </button>
                    </td>
                  </tr>
                  <tr class="hover:bg-slate-50 dark:hover:bg-slate-800/50">
                    <td class="px-5 py-4">
                      <div class="flex items-center gap-3">
                        <div
                          class="w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center"
                        >
                          <span
                            class="material-symbols-outlined text-purple-600 dark:text-purple-400"
                            >assignment</span
                          >
                        </div>
                        <div>
                          <p class="font-medium text-slate-900 dark:text-white">
                            Đánh giá chất lượng bác sĩ
                          </p>
                          <p class="text-sm text-slate-500 dark:text-slate-400">
                            Tạo: 10/01/2026
                          </p>
                        </div>
                      </div>
                    </td>
                    <td class="px-5 py-4 text-slate-600 dark:text-slate-400">
                      856
                    </td>
                    <td class="px-5 py-4">
                      <div class="flex items-center gap-1">
                        <span
                          class="material-symbols-outlined text-amber-500 text-[18px]"
                          >star</span
                        >
                        <span class="font-medium text-slate-900 dark:text-white"
                          >4.8</span
                        >
                      </div>
                    </td>
                    <td class="px-5 py-4">
                      <span
                        class="px-2.5 py-1 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-xs font-semibold rounded-full"
                        >Đang chạy</span
                      >
                    </td>
                    <td class="px-5 py-4 text-right">
                      <button
                        class="text-primary hover:text-primary-dark font-medium text-sm"
                      >
                        Xem chi tiết
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </main>

    <th:block th:replace="~{fragments/layout :: scripts}"></th:block>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Satisfaction Chart
        new Chart(document.getElementById("satisfactionChart"), {
          type: "line",
          data: {
            labels: [
              "T1",
              "T2",
              "T3",
              "T4",
              "T5",
              "T6",
              "T7",
              "T8",
              "T9",
              "T10",
              "T11",
              "T12",
            ],
            datasets: [
              {
                label: "Điểm hài lòng",
                data: [
                  4.2, 4.3, 4.1, 4.4, 4.5, 4.3, 4.6, 4.5, 4.7, 4.6, 4.5, 4.6,
                ],
                borderColor: "#0d7cf2",
                backgroundColor: "rgba(13, 124, 242, 0.1)",
                fill: true,
                tension: 0.4,
              },
            ],
          },
          options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: { y: { min: 1, max: 5 } },
          },
        });

        // Distribution Chart
        new Chart(document.getElementById("distributionChart"), {
          type: "doughnut",
          data: {
            labels: ["5 sao", "4 sao", "3 sao", "2 sao", "1 sao"],
            datasets: [
              {
                data: [45, 30, 15, 7, 3],
                backgroundColor: [
                  "#22c55e",
                  "#84cc16",
                  "#eab308",
                  "#f97316",
                  "#ef4444",
                ],
              },
            ],
          },
          options: {
            responsive: true,
            plugins: { legend: { position: "bottom" } },
          },
        });
      });
    </script>
  </body>
</html>
