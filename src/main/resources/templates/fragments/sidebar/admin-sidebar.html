<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <!--
    ABClinic - Admin Sidebar Fragment
    Contains the sidebar navigation for admin role
    
    @version 2.0.0 - Refactored
    @date February 1, 2026
    -->
  </head>
  <body>
    <!-- ==================================================================================
         SIDEBAR BACKDROP (Mobile)
         ================================================================================== -->
    <div
      th:fragment="sidebar-backdrop"
      data-sidebar-backdrop
      class="fixed inset-0 bg-black/50 z-30 hidden lg:hidden"
      aria-hidden="true"
    ></div>

    <!-- ==================================================================================
         ADMIN SIDEBAR
         ================================================================================== -->
    <aside
      th:fragment="admin-sidebar"
      data-sidebar
      aria-label="Menu điều hướng chính"
      class="w-64 bg-white dark:bg-[#1a2634] border-r border-slate-200 dark:border-slate-800 flex flex-col shrink-0 transition-all duration-300 fixed lg:relative inset-y-0 left-0 z-40 sidebar-hidden lg:sidebar-open"
    >
      <!-- Logo Section -->
      <div
        class="h-16 flex items-center px-6 border-b border-slate-200 dark:border-slate-800"
      >
        <a
          th:href="@{/admin/dashboard}"
          class="flex items-center gap-2 text-primary"
        >
          <span class="material-symbols-outlined fill text-[28px]"
            >admin_panel_settings</span
          >
          <h1
            class="sidebar-text sidebar-logo-text text-xl font-bold tracking-tight text-slate-900 dark:text-white"
          >
            ABClinic
          </h1>
        </a>
      </div>

      <!-- Navigation Menu -->
      <div class="flex-1 overflow-y-auto py-4 px-3 space-y-1">
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/admin/dashboard"
          th:href="@{/admin/dashboard}"
          title="Bảng điều khiển"
        >
          <span class="material-symbols-outlined text-[20px]">dashboard</span>
          <span class="sidebar-text text-sm font-medium">Bảng điều khiển</span>
        </a>
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/admin/accounts"
          th:href="@{/admin/accounts}"
          title="Quản lý tài khoản"
        >
          <span class="material-symbols-outlined text-[20px]"
            >manage_accounts</span
          >
          <span class="sidebar-text text-sm font-medium"
            >Quản lý tài khoản</span
          >
        </a>
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/admin/users"
          th:href="@{/admin/users}"
          title="Quản lý người dùng"
        >
          <span class="material-symbols-outlined text-[20px]">groups</span>
          <span class="sidebar-text text-sm font-medium"
            >Quản lý người dùng</span
          >
        </a>
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/admin/reports"
          th:href="@{/reports}"
          title="Báo cáo"
        >
          <span class="material-symbols-outlined text-[20px]">assessment</span>
          <span class="sidebar-text text-sm font-medium"
            >Báo cáo & Thống kê</span
          >
        </a>
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/crm"
          th:href="@{/crm/tickets}"
          title="CRM"
        >
          <span class="material-symbols-outlined text-[20px]"
            >support_agent</span
          >
          <span class="sidebar-text text-sm font-medium">CRM & Hỗ trợ</span>
        </a>
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/ai"
          th:href="@{/ai/calls}"
          title="AI & Tích hợp"
        >
          <span class="material-symbols-outlined text-[20px]">smart_toy</span>
          <span class="sidebar-text text-sm font-medium">AI & Tích hợp</span>
        </a>
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/admin/settings"
          th:href="@{/admin/settings}"
          title="Cài đặt"
        >
          <span class="material-symbols-outlined text-[20px]">settings</span>
          <span class="sidebar-text text-sm font-medium">Cài đặt hệ thống</span>
        </a>
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/admin/profile"
          th:href="@{/admin/profile}"
          title="Hồ sơ cá nhân"
        >
          <span class="material-symbols-outlined text-[20px]">person</span>
          <span class="sidebar-text text-sm font-medium">Hồ sơ cá nhân</span>
        </a>
      </div>

      <!-- User Profile Section -->
      <div class="p-4 border-t border-slate-200 dark:border-slate-800">
        <a
          th:href="@{/admin/profile}"
          class="bg-slate-50 dark:bg-slate-800 rounded-lg p-3 flex items-center gap-3 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors"
        >
          <div
            class="bg-primary rounded-full size-10 shrink-0 flex items-center justify-center text-white font-semibold"
          >
            <span
              th:if="${admin != null}"
              th:text="${admin.userInfo != null && admin.userInfo.fullName != null} ? ${admin.userInfo.fullName.substring(0,1)} : 'A'"
              >A</span
            >
            <span th:unless="${admin != null}">A</span>
          </div>
          <div class="overflow-hidden sidebar-text">
            <p
              class="text-sm font-bold text-slate-900 dark:text-white truncate"
              th:text="${admin != null && admin.userInfo != null} ? ${admin.userInfo.fullName} : 'Admin'"
            >
              Admin
            </p>
            <p class="text-xs text-slate-500 dark:text-slate-400 truncate">
              Quản trị viên
            </p>
          </div>
        </a>
        <form th:action="@{/auth/logout}" method="post" class="mt-3">
          <button
            type="submit"
            class="w-full flex items-center justify-center gap-2 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
          >
            <span class="material-symbols-outlined text-[20px]">logout</span>
            <span class="sidebar-text">Đăng xuất</span>
          </button>
        </form>
      </div>

      <!-- Active menu highlight script -->
      <script>
        (function () {
          const currentPath = window.location.pathname;
          const menuItems = document.querySelectorAll(".menu-item");
          menuItems.forEach((item) => {
            const itemPath = item.getAttribute("data-path");
            if (itemPath && currentPath.startsWith(itemPath)) {
              item.classList.add(
                "bg-primary/10",
                "text-primary",
                "dark:text-primary",
              );
              item.classList.remove("text-slate-600", "dark:text-slate-400");
              const icon = item.querySelector(".material-symbols-outlined");
              if (icon) {
                icon.style.fontVariationSettings =
                  '"FILL" 1, "wght" 400, "GRAD" 0, "opsz" 24';
              }
            }
          });
        })();
      </script>
    </aside>
  </body>
</html>
