<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <style>
      /* Receptionist Sidebar Mobile Hidden State */
      @media (max-width: 1023px) {
        .sidebar-hidden {
          transform: translateX(-100%);
        }
        .sidebar-open {
          transform: translateX(0);
        }
      }

      /* Receptionist Sidebar Desktop Collapsed State */
      @media (min-width: 1024px) {
        .sidebar-collapsed {
          width: 4.5rem !important;
        }
        .sidebar-collapsed .sidebar-text {
          display: none;
        }
        .sidebar-collapsed .menu-item {
          justify-content: center;
          padding-left: 0.75rem;
          padding-right: 0.75rem;
          position: relative;
        }
        .sidebar-collapsed .menu-item:hover::after {
          content: attr(title);
          position: absolute;
          left: 100%;
          top: 50%;
          transform: translateY(-50%);
          margin-left: 0.5rem;
          padding: 0.5rem 0.75rem;
          background-color: #1e293b;
          color: white;
          border-radius: 0.375rem;
          font-size: 0.875rem;
          white-space: nowrap;
          z-index: 50;
          pointer-events: none;
          box-shadow:
            0 4px 6px -1px rgba(0, 0, 0, 0.1),
            0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .sidebar-collapsed .p-4 > a > .overflow-hidden {
          display: none;
        }
        .sidebar-collapsed .p-4 > a > div.bg-primary {
          margin: 0 auto;
        }
        .sidebar-collapsed form button .sidebar-text {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- Mobile Sidebar Backdrop Fragment -->
    <div
      th:fragment="receptionist-sidebar-backdrop"
      data-sidebar-backdrop
      class="fixed inset-0 bg-black/50 z-30 hidden lg:hidden"
    ></div>

    <!-- Receptionist Sidebar Fragment -->
    <aside
      th:fragment="receptionist-sidebar"
      data-sidebar
      aria-label="Menu điều hướng chính"
      class="w-64 bg-white dark:bg-[#1a2634] border-r border-slate-200 dark:border-slate-800 flex flex-col shrink-0 transition-all duration-300 fixed lg:relative inset-y-0 left-0 z-40 sidebar-hidden lg:sidebar-open"
    >
      <!-- Logo Section -->
      <div
        class="h-16 flex items-center px-6 border-b border-slate-200 dark:border-slate-800"
      >
        <a
          th:href="@{/receptionist/dashboard}"
          class="flex items-center gap-2 text-primary"
        >
          <span class="material-symbols-outlined fill text-[28px]"
            >support_agent</span
          >
          <h1
            class="sidebar-text text-xl font-bold tracking-tight text-slate-900 dark:text-white"
          >
            ABClinic
          </h1>
        </a>
      </div>

      <!-- Navigation Menu -->
      <div class="flex-1 overflow-y-auto py-4 px-3 space-y-1">
        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/receptionist/dashboard"
          th:href="@{/receptionist/dashboard}"
          title="Bảng điều khiển"
        >
          <span class="material-symbols-outlined text-[20px]">dashboard</span>
          <span class="sidebar-text text-sm font-medium">Bảng điều khiển</span>
        </a>

        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/receptionist/callbot"
          th:href="@{/receptionist/callbot}"
          title="AI Callbot"
        >
          <span class="material-symbols-outlined text-[20px]">call</span>
          <span class="sidebar-text text-sm font-medium">AI Callbot</span>
        </a>

        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/receptionist/users"
          th:href="@{/receptionist/users}"
          title="Quản lý bệnh nhân"
        >
          <span class="material-symbols-outlined text-[20px]"
            >personal_injury</span
          >
          <span class="sidebar-text text-sm font-medium"
            >Quản lý bệnh nhân</span
          >
        </a>

        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/receptionist/google-form-patients"
          th:href="@{/receptionist/google-form-patients}"
          title="Bệnh nhân Google Form"
        >
          <span class="material-symbols-outlined text-[20px]">quiz</span>
          <span class="sidebar-text text-sm font-medium"
            >Bệnh nhân Google Form</span
          >
        </a>

        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/receptionist/surveys"
          th:href="@{/receptionist/surveys}"
          title="Quản lý Survey"
        >
          <span class="material-symbols-outlined text-[20px]">quiz</span>
          <span class="sidebar-text text-sm font-medium">Quản lý Survey</span>
        </a>

        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/receptionist/tickets"
          th:href="@{/receptionist/tickets}"
          title="Ticket hỗ trợ"
        >
          <span class="material-symbols-outlined text-[20px]"
            >confirmation_number</span
          >
          <span class="sidebar-text text-sm font-medium">Ticket hỗ trợ</span>
        </a>

        <a
          class="menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white group transition-colors"
          data-path="/receptionist/profile"
          th:href="@{/receptionist/profile}"
          title="Hồ sơ cá nhân"
        >
          <span class="material-symbols-outlined text-[20px]">person</span>
          <span class="sidebar-text text-sm font-medium">Hồ sơ cá nhân</span>
        </a>
      </div>

      <!-- Active menu highlight script -->
      <script>
        (function () {
          const currentPath = window.location.pathname;
          const menuItems = document.querySelectorAll(".menu-item");

          menuItems.forEach((item) => {
            const itemPath = item.getAttribute("data-path");
            if (currentPath.startsWith(itemPath)) {
              item.classList.add("bg-primary/10", "text-primary");
              item.classList.remove("text-slate-600");
              const icon = item.querySelector(".material-symbols-outlined");
              if (icon) {
                icon.style.fontVariationSettings =
                  '"FILL" 1, "wght" 400, "GRAD" 0, "opsz" 24';
              }
            }
          });
        })();
      </script>

      <!-- User Profile Section -->
      <div class="p-4 border-t border-slate-200 dark:border-slate-800">
        <a th:href="@{/receptionist/profile}" class="block">
          <div
            class="bg-slate-50 dark:bg-slate-800 rounded-lg p-3 flex items-center gap-3 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors cursor-pointer"
          >
            <div
              class="bg-primary rounded-full size-10 shrink-0 flex items-center justify-center text-white font-semibold"
            >
              <span
                th:if="${receptionist != null}"
                th:text="${receptionist.userInfo != null && receptionist.userInfo.fullName != null} ? ${receptionist.userInfo.fullName.substring(0,1)} : 'LT'"
                >LT</span
              >
              <span th:unless="${receptionist != null}">LT</span>
            </div>
            <div class="overflow-hidden sidebar-text flex-1">
              <p
                class="text-sm font-bold text-slate-900 dark:text-white truncate"
                th:text="${receptionist != null && receptionist.userInfo != null} ? ${receptionist.userInfo.fullName} : 'Lễ tân'"
              >
                Lễ tân
              </p>
              <p class="text-xs text-slate-500 dark:text-slate-400 truncate">
                Nhân viên Lễ tân
              </p>
            </div>
          </div>
        </a>
        <form th:action="@{/auth/logout}" method="post" class="mt-3">
          <button
            type="submit"
            class="w-full flex items-center justify-center gap-2 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
          >
            <span class="material-symbols-outlined text-[20px]">logout</span>
            <span class="sidebar-text">Đăng xuất</span>
          </button>
        </form>
      </div>
    </aside>

    <!-- ==================================================================================
         SCRIPTS FRAGMENT - Common JS includes for Receptionist pages
         Note: theme-controller.js is loaded in <head> to prevent flash
         ================================================================================== -->
    <th:block th:fragment="scripts">
      <!-- Sidebar Controller -->
      <script th:src="@{/js/core/sidebar-controller.js}"></script>

      <!-- Notification Dropdown -->
      <script th:src="@{/js/core/notification-dropdown.js}"></script>

      <!-- App Core (Toast notifications) -->
      <script th:src="@{/js/core/app.js}"></script>
    </th:block>
  </body>
</html>
